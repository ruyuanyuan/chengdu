require(['jquery', 'vue', 'util', 'swiper'], function ($, Vue, u, Swiper) {
var vm = new Vue({
el: '#index',
data: {
pkNewsBannerList: [],
pkNewsProvinceList: [],
pkNewsYQList: [],
pkNewsZXZCList: [],
recommendList: [],
bannerList: [],
ydyyList: [
{
img: '/parkPro/page/img/cloud1.png',
title: '模具云服务',
href: 'http://os.casicloud.com/service/hl_introduce.html',
}, {
img: '/parkPro/page/img/cloud2.png',
title: '家具云服务',
href: 'http://os.casicloud.com/service/kjCloud.html',
}, {
img: '/parkPro/page/img/cloud3.png',
title: '风电云服务',
href: 'http://os.casicloud.com/fengdian/fengdian.ht',
}, {
img: '/parkPro/page/img/cloud4.png',
title: '机器人云服务',
href: 'http://os.casicloud.com/robot/robot.ht',
}, {
img: '/parkPro/page/img/cloud5.png',
title: '3D打印协同制造云服务',
href: 'http://os.casicloud.com/service/3dprints.html',
}, {
img: '/parkPro/page/img/icon_app_26.png',
mark: 'nohover',
title: 'Creo 云化版',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=e2f39f2d03884b318a515d9c34682086',
}, {
img: '/parkPro/page/img/icon_app_27.png',
mark: 'nohover',
title: 'HyperWorks 云化版',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=b9156aef998542b8b43481bd66ca013f',
}, {
img: '/parkPro/page/img/icon_app_28.png',
title: 'ANSYS 云化版',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=f6106dc96e9946e1b4cc7158d65aa093',
}, {
img: '/parkPro/page/img/icon_app_29.png',
title: '云超算',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=89e7174726ab4a01a494427406abcb88',
}, {
img: '/parkPro/page/img/icon_app_30.png',
title: '云仿真',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=46c2e760-b758-465a-b251-458cea15317f',
},
{
img: '/parkPro/page/img/icon_app_5.png',
title: '云 SRM',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=1ed56e4e00814727b3c21d1633ed8b64',
},
{
img: '/parkPro/page/img/icon_app_2.png',
title: '易云采',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=597839cb-e49a-47df-99e9-78ab6dd29ab4',
},
{
img: '/parkPro/page/img/icon_app2-3.png',
title: '经销存',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=a316e7c3b1e14d6ca09559e9d8a885e3',
},
{
img: '/parkPro/page/img/icon_app_26.png',
title: '云排产',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=4cd2578e3df746bf848b955739d8668c',
},
{
img: '/parkPro/page/img/icon_app_26.png',
title: '计划行程',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=fcd9e6ad424f442fb91a48da9148d872',
},
{
img: '/parkPro/page/img/icon_app_27.png',
title: '统计过程控制',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=b8ffcc39-21e9-4d25-b12e-915950b1902e',
},
{
img: '/parkPro/page/img/icon_app_28.png',
title: '设备物联',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=4c6cb8a7954e4debae9f49be9dc46b9a',
},
{
img: '/parkPro/page/img/icon_app_29.png',
title: '产线控制',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=eb686f096aca40898a92bc1c55c8aeea',
},
{
img: '/parkPro/page/img/icon_app_26.png',
title: '电机故障诊断与预测服务',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=f41ad8182cbc4a79950047df10c08428',
},
{
img: '/parkPro/page/img/icon_app_26.png',
title: '水务管理平台',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=c883d631332142f7bbe31f04ee729172',
},
{
img: '/parkPro/page/img/icon_app_27.png',
title: '电动汽车充电运营',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=aff9032b6e054076bab7e49f6c7b9817',
},
{
img: '/parkPro/page/img/icon_app_28.png',
title: '风电运营管理',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=d03da3b124344af3893cd33ec4819aee',
},
{
img: '/parkPro/page/img/icon_app_29.png',
title: '光伏设备检测与运维',
mark: 'nohover',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=001ca1c328f2498b8d8f86cca102a516',
},
{
img: '/parkPro/page/img/cloud1.png',
title: '数据分析',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=5a6f0d4a372747188688d7cf1ddb9155',
},
{
img: '/parkPro/page/img/cloud2.png',
title: '云培训',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=d9201b7e695d46deb93b038702aab6fe',
},
{
img: '/parkPro/page/img/cloud3.png',
title: '云商旅',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=1b031d35-52d8-40ce-bf30-298b5c1058d7',
},
{
img: '/parkPro/page/img/cloud4.png',
title: '云提案',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=6474e9952a5c4141b6e8c672b0cb2c68',
},
{
img: '/parkPro/page/img/cloud5.png',
title: '云会议',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=2162a6ea3f004aa8b09bc88844541e1a',
},
{
img: '/parkPro/page/img/cloud1.png',
title: '仓储管理',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=834d642e828a4b02b498ad1f668b81b0',
},
{
img: '/parkPro/page/img/cloud1.png',
title: '电梯智能监控云服务',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=953bb26e591e4b70a50aebf68d18ce19',
},
{
img: '/parkPro/page/img/cloud2.png',
title: '远程故障诊断',
href: 'http://apps.casicloud.com/b2b/details/appDetails.ht?appId=d0a33981-d45b-4b55-b5d7-c1c2cf4ef650',
}
],
},
computed: {},
methods: {
tolink: function (url) {
if (url != '' && url != null) {
window.open(url);
}
},
tourl: function (id) {
localStorage.setItem("industryId", id);
window.open("/parkPro/system/industyData.html");
},
toparkindex: function (id) {
window.location.href = "/parkPro/page/parkIndex.html?id=" + id;
},
toservice: function (id) {
window.open("/parkService/details.html?id=" + id)
},
getPkNewsBannerList: function () {
var $this = this;
var $d = $.Deferred();
$.ajax({
url: "/pkNews/getPkNewsList",
type: "get",
success: function (data) {
if (data.length > 0) {
$this.pkNewsBannerList = data;
}
$d.resolve();
}
});
return $d.promise();
},
getBannerList: function () {
var $this = this;
var $d = $.Deferred();
$.ajax({
url: "/pkBanner/getBannerList",
type: "get",
success: function (data) {
if (data.body.length > 0) {
$this.bannerList = data.body;
console.log(data.body)
}
$d.resolve();
}
});
return $d.promise();
},
getPkNewsProvinceList: function () {
var $this = this;
$.ajax({
url: "/pkNews/getPkNewsListByType",
type: "get",
data: {
"type": 2
},
success: function (data) {

if (data.length > 0) {
$this.pkNewsProvinceList = data;
}
}
});
},
getPkNewsYQList: function () {
var $this = this;
$.ajax({
url: "/pkNews/getPkNewsListByType",
type: "get",
data: {
"type": 6
},
success: function (data) {
if (data.length > 0) {
$this.pkNewsYQList = data;
}
}
});
},

getPkNewsZXZCList: function () {
var $this = this;
$.ajax({
url: "/pkNews/getPkNewsListByType",
type: "get",
data: {
"type": 7
},
success: function (data) {

if (data.length > 0) {
$this.pkNewsZXZCList = data;
}
}
});
},


getRecommendList: function () {
var $this = this;
var $d = $.Deferred();
$.ajax({
url: "/pkPark/getRecommedParkList",
type: "get",
success: function (data) {
if (data.length > 0) {
$this.recommendList = data;
$d.resolve();
}
}
});
return $d.promise();
},

clickNews: function (id) {
window.open('/parkHome/newsDetails.html?id=' + id);
},
bannerSwipperInit: function () {
var swiper = new Swiper('.newswiper', {
loop: true,
autoplay: true,
pagination: {
el: '.swiper-pagination',
clickable: true,
},
});


}
},
mounted: function () {
var _self = this;
this.getPkNewsBannerList().then(function () {
_self.$nextTick(function () {
this.bannerSwipperInit();
})

});
this.getBannerList().then(function () {
_self.$nextTick(function () {
var swiper = new Swiper('.banner-swiper', {
loop: true,
autoplay: {
delay: 4000,
disableOnInteraction: false,
},
pagination: {
el: '.swiper-pagination',
clickable: true,
},
paginationClickable: true,
});
})

});
this.getPkNewsProvinceList();
this.getPkNewsYQList();
this.getPkNewsZXZCList();
this.getRecommendList().then(function () {
_self.$nextTick(function () {
var swiper = new Swiper('.recommend-swiper', {
loop: true,
autoplay: {
delay: 4000,
disableOnInteraction: false,
},
pagination: '.swiper-pagination',
paginationClickable: true,
slidesPerView: 1,
navigation: {
nextEl: '.recommend-button-next',
prevEl: '.recommend-button-prev',
},
observer: true,//修改swiper自己或子元素时，自动初始化swiper
observeParents: true,//修改swiper的父元素时，自动初始化swiper
onSlideChangeEnd: function (swiper) {
swiper.update();
}
});

})

});
//tab切换
$(".tab-box .tab-content li").click(function () {
$(this).addClass('active').siblings('li').removeClass('active');
var index = $(this).index();
$(this).parent().parent().parent().find('.tab-con-demo').eq(index).addClass('active').siblings('.tab-con-demo').removeClass('active');
});
//选项卡
$('.tabs_nav').on('click', '.tabs_nav_item', function () {
var index = $(this).index();
var cont = $(this).parents('.new_tab').find('.tabs_content_groups').find('.tabs_content');
$('.tabs_nav_item').removeClass('is_active');
$(this).addClass('is_active');
cont.removeClass('is_active');
cont.eq(index).addClass('is_active')
});

$('.service_tab_nav').on('click', '.tab_nav_item', function () {
var index = $(this).index();
var cont = $(this).parents('.service_tab').find('.service_tab_content').find('.tab_content_item');
$('.tab_nav_item').removeClass('is_active');
$(this).addClass('is_active');
cont.removeClass('is_active');
cont.eq(index).addClass('is_active')
});


//左边栏样式
$(function () {
$('.suspension a').mouseenter(function () {
var width = $(this).find('.side-info').width();
console.log(width);
$(this).find('.side-info').stop().animate({left: '-' + width + 'px'}, "normal", function () {
$(this).css('z-index', '0');
})
});
$('.suspension a').mouseleave(function () {
$(this).find('.side-info').css('z-index', '-1');
$(this).find('.side-info').stop().animate({left: '0px'}, "normal")
})
})
}
});

//tab切换
$(function () {
$(".tab-box .tab-content li").click(function () {
$(this).addClass('active').siblings('li').removeClass('active');
var index = $(this).index();
$(this).parent().parent().parent().find('.tab-con-demo').eq(index).addClass('active').siblings('.tab-con-demo').removeClass('active');
})
});

$(document).ready(function () {
/*canvasApp();*/
var swiper2 = new Swiper('.swiper-service', {
loop: false,
autoplay: true,
pagination: '.swiper-pagination',
paginationClickable: false,
slidesPerView: 2,
spaceBetween: 30,
navigation: {
nextEl: '.service-button-next',
prevEl: '.service-button-prev',
},
freeMode: true,
observer: true,//修改swiper自己或子元素时，自动初始化swiper
observeParents: true,//修改swiper的父元素时，自动初始化swiper
onSlideChangeEnd: function (swiper) {
swiper.update();
}
});
//轮播图
var recommendSwiper = new Swiper('.swiper-content1', {
slidesPerView: 4,
spaceBetween: 30,
slidesPerGroup: 4,
loop: true,
loopFillGroupWithBlank: true,
pagination: {
el: '.swiper-pagination',
clickable: true,
},
navigation: {
nextEl: '.swiper-button-next',
prevEl: '.swiper-button-prev',
},
});

var recommendSwiper3 = new Swiper('.swiper-content3', {
loop: true,
loopFillGroupWithBlank: true,
pagination: {
el: '.swiper-pagination',
clickable: true,
},
navigation: {
nextEl: '.swiper-button-next3',
prevEl: '.swiper-button-prev3',
},
});


$('.r_content_content').on('click', '.service_info_item', function () {
var index = $(this).index();
var cont = $(this).parents('.service_info').find('.service_info_left').find('.left_item');
$('.service_info_item').removeClass('service_item_bule');
$(this).addClass('service_item_bule');
cont.removeClass('is_active');
cont.eq(index).addClass('is_active')
})

})


});


var sphereRad = 280;
var radius_sp = 1;
var opt_display_dots = false;

var unicodeFlakes = ['园区', '企业', '产业', '一干多支', '五区协同', '创新', '绿色', '协调', '共享', '园区', '产值', '高质量', '发展', '亩产', '2019', '5+1现代产业', '电子信息', '能源化工', '食品饮料', '数字经济', '装备制造', '信息服务', '金融', '环保安全', '工业设计', 'app', '云', '航天云网', '新能源汽车', '园宝贷', '高新', '经开', '工业', 'GDP', '投资', '利润', '税金', '资产', '万亿', '图', 'GIS', '管理', '重点', '一张图', '转型', '升级', '促进', '精准招商', '融合', '区域', '云计算', '节能减排', '智慧决策', '实时监控', '工商财报', '3D', '人才', '布局', '产业链'];

//for debug messages
var Debugger = function () {
};
Debugger.log = function (message) {
try {
console.log(message);
} catch (exception) {

}
};


function canvasSupport() {
return Modernizr.canvas;
}

function canvasApp() {
if (!canvasSupport()) {
return;
}

var theCanvas = document.getElementById("canvasOne");
var context = theCanvas.getContext("2d");
var displayWidth;
var displayHeight;
var timer;
var wait;
var count;
var numToAddEachFrame;
var particleList;
var recycleBin;
var particleAlpha;
var r,
g,
b;
var fLen;
var m;
var projCenterX;
var projCenterY;
var zMax;
var turnAngle;
var turnSpeed;
var sphereCenterX,
sphereCenterY,
sphereCenterZ;
var particleRad;
var zeroAlphaDepth;
var randAccelX,
randAccelY,
randAccelZ;
var gravity;
var rgbString;
//we are defining a lot of variables used in the screen update functions globally so that they don't have to be redefined every frame.
var p;
var outsideTest;
var nextParticle;
var sinAngle;
var cosAngle;
var rotX,
rotZ;
var depthAlphaFactor;
var i;
var theta,
phi;
var x0,
y0,
z0;

init();

// INITIALLI
function init() {
wait = 1;
count = wait - 1;
numToAddEachFrame = 4;

//particle color
r = 255;
g = 255;
b = 255;
rgbString = "rgba(" + r + "," + g + "," + b + ","; //partial string for color which will be completed by appending alpha value.
particleAlpha = 1; //maximum alpha

displayWidth = theCanvas.width;
displayHeight = theCanvas.height;

fLen = 320; //represents the distance from the viewer to z=0 depth.

//projection center coordinates sets location of origin
projCenterX = displayWidth / 2;
projCenterY = displayHeight / 2;

//we will not draw coordinates if they have too large of a z-coordinate (which means they are very close to the observer).
zMax = fLen - 2;

particleList = {};
recycleBin = {};

//random acceleration factors - causes some random motion
randAccelX = 0.1;
randAccelY = 0.1;
randAccelZ = 0.1;

gravity = -0; //try changing to a positive number (not too large, for example 0.3), or negative for floating upwards.

particleRad = 2.5;

sphereCenterX = 0;
sphereCenterY = 0;
sphereCenterZ = -3 - sphereRad;

//alpha values will lessen as particles move further back, causing depth-based darkening:
zeroAlphaDepth = -750;

turnSpeed = 2 * Math.PI / 1200; //the sphere will rotate at this speed (one complete rotation every 1600 frames).
turnAngle = 0; //initial angle

timer = setInterval(onTimer, 30);
}

function onTimer() {
//if enough time has elapsed, we will add new particles.
count++;
if (count >= wait) {

count = 0;
for (i = 0; i < numToAddEachFrame; i++) {
theta = Math.random() * 2 * Math.PI;
phi = Math.acos(Math.random() * 2 - 1);
x0 = sphereRad * Math.sin(phi) * Math.cos(theta);
y0 = sphereRad * Math.sin(phi) * Math.sin(theta);
z0 = sphereRad * Math.cos(phi);

//We use the addParticle function to add a new particle. The parameters set the position and velocity components.
//Note that the velocity parameters will cause the particle to initially fly outwards away from the sphere center (after
//it becomes unstuck).
var p = addParticle(x0, sphereCenterY + y0, sphereCenterZ + z0, 0.002 * x0, 0.002 * y0, 0.002 * z0);

//we set some "envelope" parameters which will control the evolving alpha of the particles.
p.attack = 50;
p.hold = 50;
p.decay = 100;
p.initValue = 0;
p.holdValue = particleAlpha;
p.lastValue = 0;

//the particle will be stuck in one place until this time has elapsed:
p.stuckTime = 90 + Math.random() * 20;

p.accelX = 0;
p.accelY = gravity;
p.accelZ = 0;
}
}

//update viewing angle
turnAngle = (turnAngle + turnSpeed) % (2 * Math.PI);
sinAngle = Math.sin(turnAngle);
cosAngle = Math.cos(turnAngle);

//background fill
context.fillStyle = "#00509D";
context.fillRect(0, 0, displayWidth, displayHeight);

//update and draw particles
p = particleList.first;
while (p != null) {
//before list is altered record next particle
nextParticle = p.next;

//update age
p.age++;

//if the particle is past its "stuck" time, it will begin to move.
if (p.age > p.stuckTime) {
p.velX += p.accelX + randAccelX * (Math.random() * 2 - 1);
p.velY += p.accelY + randAccelY * (Math.random() * 2 - 1);
p.velZ += p.accelZ + randAccelZ * (Math.random() * 2 - 1);

p.x += p.velX;
p.y += p.velY;
p.z += p.velZ;
}

/*
We are doing two things here to calculate display coordinates.
The whole display is being rotated around a vertical axis, so we first calculate rotated coordinates for
x and z (but the y coordinate will not change).
Then, we take the new coordinates (rotX, y, rotZ), and project these onto the 2D view plane.
*/
rotX = cosAngle * p.x + sinAngle * (p.z - sphereCenterZ);
rotZ = -sinAngle * p.x + cosAngle * (p.z - sphereCenterZ) + sphereCenterZ;
m = radius_sp * fLen / (fLen - rotZ);
p.projX = rotX * m + projCenterX;
p.projY = p.y * m + projCenterY;

//update alpha according to envelope parameters.
if (p.age < p.attack + p.hold + p.decay) {
if (p.age < p.attack) {
p.alpha = (p.holdValue - p.initValue) / p.attack * p.age + p.initValue;
} else if (p.age < p.attack + p.hold) {
p.alpha = p.holdValue;
} else if (p.age < p.attack + p.hold + p.decay) {
p.alpha = (p.lastValue - p.holdValue) / p.decay * (p.age - p.attack - p.hold) + p.holdValue;
}
} else {
p.dead = true;
}

//see if the particle is still within the viewable range.
if ((p.projX > displayWidth) || (p.projX < 0) || (p.projY < 0) || (p.projY > displayHeight) || (rotZ > zMax)) {
outsideTest = true;
} else {
outsideTest = false;
}

if (outsideTest || p.dead) {
recycle(p);
} else {
//depth-dependent darkening
depthAlphaFactor = (1 - rotZ / zeroAlphaDepth);
depthAlphaFactor = (depthAlphaFactor > 1) ? 1 : ((depthAlphaFactor < 0) ? 0 : depthAlphaFactor);
context.fillStyle = rgbString + depthAlphaFactor * p.alpha + ")";
/*ADD TEXT function!*/
/*ADD TEXT function!*/
/*ADD TEXT function!*/
/*ADD TEXT function!*/
context.fillText(p.flake, p.projX, p.projY);
/*ADD TEXT function!*/
/*ADD TEXT function!*/
/*ADD TEXT function!*/
/*ADD TEXT function!*/
//draw
context.beginPath();
if (opt_display_dots) {
context.arc(p.projX, p.projY, m * particleRad, 0, 2 * Math.PI, false);
}
context.closePath();
context.fill();
}

p = nextParticle;
}
}

function addParticle(x0, y0, z0, vx0, vy0, vz0) {
var newParticle;
var color;


//check recycle bin for available drop:
if (recycleBin.first != null) {
newParticle = recycleBin.first;
//remove from bin
if (newParticle.next != null) {
recycleBin.first = newParticle.next;
newParticle.next.prev = null;
} else {
recycleBin.first = null;
}
}
//if the recycle bin is empty, create a new particle (a new ampty object):
else {
newParticle = {};
}

//add to beginning of particle list
if (particleList.first == null) {
particleList.first = newParticle;
newParticle.prev = null;
newParticle.next = null;
} else {
newParticle.next = particleList.first;
particleList.first.prev = newParticle;
particleList.first = newParticle;
newParticle.prev = null;
}

//initialize
newParticle.x = x0;
newParticle.y = y0;
newParticle.z = z0;
newParticle.velX = vx0;
newParticle.velY = vy0;
newParticle.velZ = vz0;
newParticle.age = 0;
newParticle.dead = false;

newParticle.flake = unicodeFlakes[Math.floor(Math.random() * unicodeFlakes.length)];
if (Math.random() < 0.5) {
newParticle.right = true;
} else {
newParticle.right = false;
}
return newParticle;
}

function recycle(p) {
//remove from particleList
if (particleList.first == p) {
if (p.next != null) {
p.next.prev = null;
particleList.first = p.next;
} else {
particleList.first = null;
}
} else {
if (p.next == null) {
p.prev.next = null;
} else {
p.prev.next = p.next;
p.next.prev = p.prev;
}
}
//add to recycle bin
if (recycleBin.first == null) {
recycleBin.first = p;
p.prev = null;
p.next = null;
} else {
p.next = recycleBin.first;
recycleBin.first.prev = p;
recycleBin.first = p;
p.prev = null;
}
}
}